@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:ital,wght@0,300;0,400;0,700;1,400&display=swap');

:root {
    --bg-color: #0f1012;
    --bg-gradient: radial-gradient(circle at center, #1e222b 0%, #0a0b0e 100%);
    --book-shadow: 0 30px 60px rgba(0, 0, 0, 0.8), 0 0 20px rgba(0, 0, 0, 0.4);
    --page-bg: #fff;
    --accent-color: #d4af37;
    /* Metallic Gold */
    --text-color: #eee;
    --control-bg: rgba(20, 20, 25, 0.85);
    /* Mobile variables */
    --control-border: rgba(255, 255, 255, 0.1);
}

body {
    margin: 0;
    padding: 0;
    width: 100vw;
    height: 100vh;
    background-color: var(--bg-color);
    background: var(--bg-gradient);
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Lato', sans-serif;
    color: var(--text-color);
    overflow: hidden;
}

/* Default: Hide Mobile Controls Only */
.mobile-controls {
    display: none;
}

/* Desktop Dynamic Background Styles */
#dynamicBg {
    position: fixed;
    top: -10%;
    left: -10%;
    width: 120%;
    height: 120%;
    background-size: cover;
    background-position: center;
    filter: blur(40px) brightness(0.3);
    /* Slightly darker/blurrier for desktop to focus on book */
    z-index: -2;
    transition: background-image 0.8s ease-in-out;
    /* Slower transition for premium feel */
}

#bgOverlay {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.8) 100%);
    /* Vignette effect */
    z-index: -1;
}

/* 3D Scene to give depth */
.scene {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    perspective: 2000px;
    /* Enhanced depth */
}

.book-wrapper {
    position: relative;
    /* Ensure it takes space but respects padding */
    width: 90%;
    height: 90vh;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.2s ease-out;
}

/* PageFlip Container */
.stf__wrapper {
    background: transparent !important;
    line-height: 0;
    /* Remove direct shadow */
    box-shadow: none !important;
    /* Enable positioning for pseudo-element */
    position: relative !important;
    z-index: 5;
    /* Ensure above background */
}

/* Shadow Layer via Pseudo-element */
.stf__wrapper::before {
    content: "";
    position: absolute;
    top: 0;
    height: 100%;
    z-index: -1;
    /* Behind the pages */

    /* Default: Closed Book (Cover on Right) */
    /* Only covers right half */
    left: 50%;
    width: 50%;
    box-shadow: 10px 10px 40px rgba(0, 0, 0, 0.6);
    transition: all 0.4s ease-out;
    border-radius: 0 5px 5px 0;
}

/* Open Book State (Spread) */
.stf__wrapper.open-book::before {
    left: 0;
    width: 100%;
    box-shadow: 0 10px 50px rgba(0, 0, 0, 0.7);
    border-radius: 5px;
}

/* Pages Styling - Canvas wrapper */
.my-page,
.m-page {
    background-color: var(--page-bg);
    overflow: hidden;
    border: none;
    /* Removed border to fix sizing/jump */
}

/* Cover styling */
.my-page.-hard,
.m-page.hard {
    background-color: #111;
    border: none;
    /* Removed border to fix sizing/jump */
}

/* Intro Overlay */
#introOverlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    transition: opacity 1.0s ease-out;
    /* Fade out effect */
}

/* Container to center text */
.intro-text-container {
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* Cinematic Gold Text */
.gold-text,
.gold-text-sub {
    font-family: 'Cinzel', serif;
    color: transparent;
    background: linear-gradient(to bottom, #cfc09f 22%, #634f2c 24%, #cfc09f 26%, #cfc09f 27%, #ffecb3 40%, #3a2c0f 78%);
    -webkit-background-clip: text;
    background-clip: text;
    text-transform: uppercase;
    margin: 0;
    opacity: 0;
    /* Starte hidden */
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    white-space: nowrap;
    /* Keep on one line for typing */
    overflow: hidden;
    /* Hide overflow */
    border-right: 2px solid transparent;
    /* Cursor */
}

.gold-text {
    font-size: 3.5rem;
    font-weight: 700;
    letter-spacing: 5px;
    animation: typeReveal 1s steps(20, end) forwards,
        blinkCursor 0.5s step-end 3 forwards;
}

.gold-text-sub {
    font-size: 2rem;
    font-weight: 400;
    letter-spacing: 8px;
    margin-top: 10px;
    /* Delays start until first line is done */
    animation: typeReveal 1s steps(20, end) 1s forwards,
        blinkCursor 0.5s step-end 3 1s forwards;
}

/* Animations */
@keyframes typeReveal {
    0% {
        width: 0;
        opacity: 1;
        border-right-color: #d4af37;
    }

    99% {
        border-right-color: #d4af37;
    }

    100% {
        width: 100%;
        opacity: 1;
        border-right-color: transparent;
    }
}

@keyframes blinkCursor {

    from,
    to {
        border-color: transparent;
    }

    50% {
        border-color: #d4af37;
    }
}

/* Mobile sizing for intro */
@media (max-width: 768px) {
    .gold-text {
        font-size: 1.8rem;
        letter-spacing: 2px;
    }

    .gold-text-sub {
        font-size: 1.2rem;
        letter-spacing: 3px;
    }
}

/* Loading Overlay */
#loadingOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(circle at center, #1b2028 0%, #000 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.8s ease;
}

.loader-content {
    text-align: center;
    color: var(--accent-color);
    font-family: 'Cinzel', serif;
    letter-spacing: 2px;
}

.spinner {
    width: 60px;
    height: 60px;
    border: 2px solid rgba(212, 175, 55, 0.1);
    border-radius: 50%;
    border-top: 2px solid var(--accent-color);
    animation: spin 1s cubic-bezier(0.5, 0.1, 0.5, 0.9) infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Controls UI (Desktop) */
.controls {
    position: fixed;
    bottom: 30px;
    display: flex;
    gap: 15px;
    align-items: center;
    background: var(--control-bg);
    padding: 10px 30px;
    border-radius: 60px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(12px);
    z-index: 100;
}

.control-btn {
    background: transparent;
    border: none;
    color: #888;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Cinzel', serif;
    font-weight: 700;
    transition: all 0.3s ease;
    text-transform: uppercase;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.control-btn:hover {
    color: var(--accent-color);
    text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
    transform: translateY(-2px);
}

.separator {
    width: 1px;
    height: 20px;
    background: rgba(255, 255, 255, 0.1);
    margin: 0 10px;
}

.page-nav {
    display: flex;
    align-items: center;
    gap: 8px;
    font-family: 'Cinzel', serif;
    color: #666;
    font-size: 0.9rem;
}

.page-input {
    width: 40px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    color: var(--accent-color);
    text-align: center;
    padding: 5px;
    font-family: inherit;
    font-weight: bold;
    transition: all 0.3s;
}

.page-input:focus {
    outline: none;
    border-color: var(--accent-color);
    background: rgba(0, 0, 0, 0.4);
}

#zoomDisplay {
    font-family: 'Lato', sans-serif;
    font-size: 0.8rem;
    color: #666;
    min-width: 40px;
    text-align: center;
    font-weight: 300;
}

#pageInfo {
    color: #666;
    font-size: 0.8rem;
}

/* Canvas and Image responsiveness */
canvas,
img {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain;
    display: block;
}

.book-wrapper {
    transition: transform 0.2s ease-out;
    will-change: transform;
}

* {
    box-sizing: border-box;
}

@keyframes cinematicSlam {
    0% {
        opacity: 0;
        transform: scale(4.0);
        filter: blur(15px);
    }

    20% {
        opacity: 1;
        transform: scale(1.0);
        filter: blur(0px) brightness(1.0);
    }

    25% {
        filter: brightness(2.0);
        transform: scale(1.02);
    }

    40% {
        filter: brightness(1.0);
        transform: scale(1.0);
    }

    100% {
        opacity: 1;
        transform: scale(1.05);
    }
}

/* =========================================
   MOBILE RESPONSIVENESS (Merged from mobile.css)
   ========================================= */
@media (max-width: 768px) {

    /* Hide Desktop Controls */
    .controls {
        display: none !important;
    }

    /* Show Mobile Elements */
    #dynamicBg,
    #bgOverlay {
        display: block;
    }

    /* Scene / Viewport Adjustments */
    .scene {
        /* Mobile "viewport" equivalent */
        overflow: hidden;
        touch-action: none;
    }

    /* Mobile Background Styles */
    #dynamicBg {
        position: fixed;
        top: -10%;
        left: -10%;
        width: 120%;
        height: 120%;
        background-size: cover;
        background-position: center;
        filter: blur(30px) brightness(0.4);
        z-index: -2;
        transition: background-image 0.5s ease-in-out;
    }

    #bgOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: -1;
    }

    /* Intro Logo Sizing for Mobile */
    .intro-logo {
        width: 60%;
        max-width: 300px;
    }

    /* Mobile Controls */
    .mobile-controls {
        display: flex;
        position: fixed;
        bottom: 25px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--control-bg);
        padding: 10px 25px;
        border-radius: 50px;
        gap: 20px;
        align-items: center;
        z-index: 100;
        backdrop-filter: blur(15px);
        border: 1px solid var(--control-border);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    }

    .m-btn {
        background: transparent;
        border: none;
        color: var(--text-color);
        width: 44px;
        height: 44px;
        border-radius: 50%;
        font-size: 1.4rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .m-btn:active {
        transform: scale(0.9);
        background: rgba(255, 255, 255, 0.1);
    }

    #mPageInfo {
        font-family: 'Cinzel', serif;
        font-size: 0.9rem;
        color: var(--accent-color);
        min-width: 60px;
        text-align: center;
        font-weight: 700;
        letter-spacing: 1px;
    }

    /* PageFlip Overrides for Mobile */
    .stf__wrapper {
        width: 100% !important;
        height: auto !important;
        margin: auto;
    }

    .stf__block {
        max-width: 100%;
    }

    /* Ensure shadows are hidden/managed well on mobile single view */
    .stf__wrapper::before {
        display: none !important;
    }

    .stf__wrapper.open-book::before {
        display: none !important;
    }

    /* Reset book wrapper for mobile "centered" view */
    .book-wrapper {
        width: 100%;
        height: 100%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        /* The wrapper itself might not need shadow if the book has one,
           but let's keep it simple or remove it if it looks double.
           Actually in mobile.css 'book' had shadow, here 'book-wrapper' is the container.
           Let's apply shadow to '#book' instead if possible, but strict.js uses wrapper structure.
           Let's just remove wrapper shadow for mobile to be clean. */
        box-shadow: none !important;
    }

    #book {
        /* Mobile specific shadow on book element instead */
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
}